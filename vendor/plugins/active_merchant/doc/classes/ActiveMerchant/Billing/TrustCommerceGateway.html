<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: ActiveMerchant::Billing::TrustCommerceGateway</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href="../../.././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">ActiveMerchant::Billing::TrustCommerceGateway</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../../../files/lib/active_merchant/billing/gateways/trust_commerce_rb.html">
                lib/active_merchant/billing/gateways/trust_commerce.rb
                </a>
        <br />
            </td>
        </tr>

        <tr class="top-aligned-row">
            <td><strong>Parent:</strong></td>
            <td>
                <a href="Gateway.html">
                Gateway
               </a>
            </td>
        </tr>
        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <p>
To get started using TrustCommerce with active_merchant, download the
tclink library from <a
href="http://www.trustcommerce.com/tclink.html">www.trustcommerce.com/tclink.html</a>,
following the instructions available there to get it working on your
system. Once it is installed, you should be able to make sure that it is
visible to your ruby install by opening irb and typing &quot;require
&#8216;tclink&#8217;&quot;, which should return &quot;true&quot;.
</p>
<p>
TO USE: First, make sure you have everything setup correctly and all of
your dependencies in place with:
</p>
<pre>
  require 'rubygems'
  require 'money'
  require 'active_merchant'
</pre>
<p>
The second line is a require for the &#8216;money&#8217; library. Make sure
you have it installed with &#8216;gem install money&#8217;
</p>
<p>
Using the money library, create a money object. Pass the dollar value in
cents. In this case, $10 US becomes 1000.
</p>
<pre>
  tendollar = Money.us_dollar(1000)
</pre>
<p>
Next, create a credit card object using a TC approved test card.
</p>
<pre>
  creditcard = ActiveMerchant::Billing::CreditCard.new({
      :number =&gt; '4111111111111111',
      :month =&gt; 8,
      :year =&gt; 2006,
      :first_name =&gt; 'Longbob',
    :last_name =&gt; 'Longsen'
  })
</pre>
<p>
To finish setting up, create the active_merchant object you will be using,
with the TrustCommerce gateway. If you have a functional TrustCommerce
account, replace login and password with your account info. Otherwise the
defaults will work for testing.
</p>
<pre>
  gateway = ActiveMerchant::Billing::Base.gateway(:trust_commerce).new(:login =&gt; &quot;TestMerchant&quot;, :password =&gt; &quot;password&quot;)
</pre>
<p>
Now we are ready to process our transaction
</p>
<pre>
  response = gateway.purchase(tendollar, creditcard)
</pre>
<p>
Sending a transaction to TrustCommerce with active_merchant returns a <a
href="Response.html">Response</a> object, which consistently allows you to:
</p>
<p>
1) Check whether the transaction was successful
</p>
<pre>
  response.success?
</pre>
<p>
2) Retrieve any message returned by TrustCommerce, either a
&quot;transaction was successful&quot; note or an explanation of why the
transaction was rejected.
</p>
<pre>
  response.message
</pre>
<p>
3) Retrieve and store the unique transaction ID returned by Trust
Commerece, for use in referencing the transaction in the future.
</p>
<pre>
  response.params[&quot;transid&quot;]
</pre>
<p>
This should be enough to get you started with Trust Commerce and
active_merchant. For further information, review the methods below and the
rest of active_merchant&#8217;s documentation, as well as Trust
Commerce&#8217;s user and developer documentation.
</p>

    </div>


   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000154">authorize</a>&nbsp;&nbsp;
      <a href="#M000156">capture</a>&nbsp;&nbsp;
      <a href="#M000157">credit</a>&nbsp;&nbsp;
      <a href="#M000153">new</a>&nbsp;&nbsp;
      <a href="#M000155">purchase</a>&nbsp;&nbsp;
      <a href="#M000158">recurring</a>&nbsp;&nbsp;
      <a href="#M000159">store</a>&nbsp;&nbsp;
      <a href="#M000161">supported_cardtypes</a>&nbsp;&nbsp;
      <a href="#M000160">unstore</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->

    <div id="section">


    <div id="constants-list">
      <h3 class="section-bar">Constants</h3>

      <div class="name-list">
        <table summary="Constants">
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">SUCCESS_TYPES</td>
          <td>=</td>
          <td class="context-item-value">[&quot;approved&quot;, &quot;accepted&quot;]</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">DECLINE_CODES</td>
          <td>=</td>
          <td class="context-item-value">{         &quot;decline&quot;       =&gt; &quot;The credit card was declined&quot;,         &quot;avs&quot;           =&gt; &quot;AVS failed; the address entered does not match the billing address on file at the bank&quot;,         &quot;cvv&quot;           =&gt; &quot;CVV failed; the number provided is not the correct verification number for the card&quot;,         &quot;call&quot;          =&gt; &quot;The card must be authorized manually over the phone&quot;,         &quot;expiredcard&quot;   =&gt; &quot;Issuer was not certified for card verification&quot;,         &quot;carderror&quot;     =&gt; &quot;Card number is invalid&quot;,         &quot;authexpired&quot;   =&gt; &quot;Attempt to postauth an expired (more than 14 days old) preauth&quot;,         &quot;fraud&quot;         =&gt; &quot;CrediGuard fraud score was below requested threshold&quot;,         &quot;blacklist&quot;     =&gt; &quot;CrediGuard blacklist value was triggered&quot;,          &quot;velocity&quot;      =&gt; &quot;CrediGuard velocity control value was triggered&quot;,         &quot;dailylimit&quot;    =&gt; &quot;Daily limit in transaction count or amount as been reached&quot;,         &quot;weeklylimit&quot;   =&gt; &quot;Weekly limit in transaction count or amount as been reached&quot;,         &quot;monthlylimit&quot;  =&gt; &quot;Monthly limit in transaction count or amount as been reached&quot;</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">BADDATA_CODES</td>
          <td>=</td>
          <td class="context-item-value">{         &quot;missingfields&quot;       =&gt; &quot;One or more parameters required for this transaction type were not sent&quot;,         &quot;extrafields&quot;         =&gt; &quot;Parameters not allowed for this transaction type were sent&quot;,         &quot;badformat&quot;           =&gt; &quot;A field was improperly formatted, such as non-digit characters in a number field&quot;,         &quot;badlength&quot;           =&gt; &quot;A field was longer or shorter than the server allows&quot;,         &quot;merchantcantaccept&quot;  =&gt; &quot;The merchant can't accept data passed in this field&quot;,         &quot;mismatch&quot;            =&gt; &quot;Data in one of the offending fields did not cross-check with the other offending field&quot;</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">ERROR_CODES</td>
          <td>=</td>
          <td class="context-item-value">{         &quot;cantconnect&quot;   =&gt; &quot;Couldn't connect to the TrustCommerce gateway&quot;,         &quot;dnsfailure&quot;    =&gt; &quot;The TCLink software was unable to resolve DNS hostnames&quot;,         &quot;linkfailure&quot;   =&gt; &quot;The connection was established, but was severed before the transaction could complete&quot;,         &quot;failtoprocess&quot; =&gt; &quot;The bank servers are offline and unable to authorize transactions&quot;</td>
        </tr>
        </table>
      </div>
    </div>



    <div id="attribute-list">
      <h3 class="section-bar">Attributes</h3>

      <div class="name-list">
        <table>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">options</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">response</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">url</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc">
URL

</td>
        </tr>
        </table>
      </div>
    </div>
      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Class methods</h3>

      <div id="method-M000153" class="method-detail">
        <a name="M000153"></a>

        <div class="method-heading">
          <a href="#M000153" class="method-signature">
          <span class="method-name">new</span><span class="method-args">(options = {})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000153-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000153-source">
<pre>
     <span class="ruby-comment cmt"># File lib/active_merchant/billing/gateways/trust_commerce.rb, line 107</span>
107:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">options</span> = {})
108:         <span class="ruby-identifier">requires!</span>(<span class="ruby-identifier">options</span>, <span class="ruby-identifier">:login</span>, <span class="ruby-identifier">:password</span>)
109:         <span class="ruby-comment cmt"># these are the defaults for trustcommerce</span>
110:         <span class="ruby-ivar">@options</span> = {
111:           <span class="ruby-identifier">:login</span>      =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;TestMerchant&quot;</span>,
112:           <span class="ruby-identifier">:password</span>   =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;password&quot;</span>
113:         }.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">options</span>)
114: 
115:         <span class="ruby-keyword kw">super</span>
116:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000161" class="method-detail">
        <a name="M000161"></a>

        <div class="method-heading">
          <a href="#M000161" class="method-signature">
          <span class="method-name">supported_cardtypes</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000161-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000161-source">
<pre>
     <span class="ruby-comment cmt"># File lib/active_merchant/billing/gateways/trust_commerce.rb, line 239</span>
239:       <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">supported_cardtypes</span>
240:         [<span class="ruby-identifier">:visa</span>, <span class="ruby-identifier">:master</span>, <span class="ruby-identifier">:discover</span>, <span class="ruby-identifier">:american_express</span>, <span class="ruby-identifier">:diners_club</span>, <span class="ruby-identifier">:jcb</span>]
241:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000154" class="method-detail">
        <a name="M000154"></a>

        <div class="method-heading">
          <a href="#M000154" class="method-signature">
          <span class="method-name">authorize</span><span class="method-args">(money, creditcard, options = {})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
authorize() is the first half of the preauth(authorize)/postauth(capture)
model. The TC API docs call this preauth, we preserve
active_merchant&#8217;s nomenclature of authorize() for consistency with
the rest of the library. This method simply checks to make sure funds are
available for a transaction, and returns a transid that can be used later
to postauthorize (capture) the funds.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000154-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000154-source">
<pre>
     <span class="ruby-comment cmt"># File lib/active_merchant/billing/gateways/trust_commerce.rb, line 123</span>
123:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">authorize</span>(<span class="ruby-identifier">money</span>, <span class="ruby-identifier">creditcard</span>, <span class="ruby-identifier">options</span> = {})
124:         <span class="ruby-identifier">parameters</span> = {
125:           <span class="ruby-identifier">:amount</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">amount</span>(<span class="ruby-identifier">money</span>),
126:         }                                                             
127:         
128:         <span class="ruby-identifier">add_creditcard</span>(<span class="ruby-identifier">parameters</span>, <span class="ruby-identifier">creditcard</span>)
129:         <span class="ruby-identifier">add_address</span>(<span class="ruby-identifier">parameters</span>, <span class="ruby-identifier">options</span>)
130:         <span class="ruby-identifier">commit</span>(<span class="ruby-value str">'preauth'</span>, <span class="ruby-identifier">parameters</span>)
131:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000156" class="method-detail">
        <a name="M000156"></a>

        <div class="method-heading">
          <a href="#M000156" class="method-signature">
          <span class="method-name">capture</span><span class="method-args">(money, authorization, options = {})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
capture() is the second half of the preauth(authorize)/postauth(capture)
model. The TC API docs call this postauth, we preserve
active_merchant&#8217;s nomenclature of capture() for consistency with the
rest of the library. To process a postauthorization with TC, you need an
amount in cents or a money object, and a TC transid.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000156-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000156-source">
<pre>
     <span class="ruby-comment cmt"># File lib/active_merchant/billing/gateways/trust_commerce.rb, line 150</span>
150:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">capture</span>(<span class="ruby-identifier">money</span>, <span class="ruby-identifier">authorization</span>, <span class="ruby-identifier">options</span> = {})
151:         <span class="ruby-identifier">parameters</span> = {
152:           <span class="ruby-identifier">:amount</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">amount</span>(<span class="ruby-identifier">money</span>),
153:           <span class="ruby-identifier">:transid</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">authorization</span>,
154:         }
155:                                                   
156:         <span class="ruby-identifier">commit</span>(<span class="ruby-value str">'postauth'</span>, <span class="ruby-identifier">parameters</span>)
157:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000157" class="method-detail">
        <a name="M000157"></a>

        <div class="method-heading">
          <a href="#M000157" class="method-signature">
          <span class="method-name">credit</span><span class="method-args">(money, identification, options = {})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
credit() allows you to return money to a card that was previously billed.
You need to supply the amount, in cents or a money object, that you want to
refund, and a TC transid for the transaction that you are refunding.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000157-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000157-source">
<pre>
     <span class="ruby-comment cmt"># File lib/active_merchant/billing/gateways/trust_commerce.rb, line 162</span>
162:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">credit</span>(<span class="ruby-identifier">money</span>, <span class="ruby-identifier">identification</span>, <span class="ruby-identifier">options</span> = {})  
163:         <span class="ruby-identifier">parameters</span> = {
164:           <span class="ruby-identifier">:amount</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">amount</span>(<span class="ruby-identifier">money</span>),
165:           <span class="ruby-identifier">:transid</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">identification</span>,
166:         }
167:                                                   
168:         <span class="ruby-identifier">commit</span>(<span class="ruby-value str">'credit'</span>, <span class="ruby-identifier">parameters</span>)
169:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000155" class="method-detail">
        <a name="M000155"></a>

        <div class="method-heading">
          <a href="#M000155" class="method-signature">
          <span class="method-name">purchase</span><span class="method-args">(money, creditcard, options = {})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
purchase() is a simple sale. This is one of the most common types of
transactions, and is extremely simple. All that you need to process a
purchase are an amount in cents or a money object and a creditcard object.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000155-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000155-source">
<pre>
     <span class="ruby-comment cmt"># File lib/active_merchant/billing/gateways/trust_commerce.rb, line 136</span>
136:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">purchase</span>(<span class="ruby-identifier">money</span>, <span class="ruby-identifier">creditcard</span>, <span class="ruby-identifier">options</span> = {})        
137:         <span class="ruby-identifier">parameters</span> = {
138:           <span class="ruby-identifier">:amount</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">amount</span>(<span class="ruby-identifier">money</span>),
139:         }                                                             
140:         
141:         <span class="ruby-identifier">add_creditcard</span>(<span class="ruby-identifier">parameters</span>, <span class="ruby-identifier">creditcard</span>)
142:         <span class="ruby-identifier">add_address</span>(<span class="ruby-identifier">parameters</span>, <span class="ruby-identifier">options</span>)
143:         <span class="ruby-identifier">commit</span>(<span class="ruby-value str">'sale'</span>, <span class="ruby-identifier">parameters</span>)
144:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000158" class="method-detail">
        <a name="M000158"></a>

        <div class="method-heading">
          <a href="#M000158" class="method-signature">
          <span class="method-name">recurring</span><span class="method-args">(money, creditcard, options = {})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
recurring() a TrustCommerce account that is activated for Citatdel,
TrustCommerce&#8217;s hosted customer billing info database.
</p>
<p>
Recurring billing uses the same TC action as a plain-vanilla
&#8216;store&#8217;, but we have a separate method for clarity. It can be
called like store, with the addition of a required
&#8216;periodicity&#8217; parameter:
</p>
<p>
The parameter :periodicity should be specified as either :bimonthly,
:monthly, :biweekly, :weekly, :yearly or :daily
</p>
<pre>
  gateway.recurring(tendollar, creditcard, :periodicity =&gt; :weekly)
</pre>
<p>
You can optionally specify how long you want payments to continue using
&#8216;payments&#8217;
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000158-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000158-source">
<pre>
     <span class="ruby-comment cmt"># File lib/active_merchant/billing/gateways/trust_commerce.rb, line 183</span>
183:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">recurring</span>(<span class="ruby-identifier">money</span>, <span class="ruby-identifier">creditcard</span>, <span class="ruby-identifier">options</span> = {})        
184:         <span class="ruby-identifier">requires!</span>(<span class="ruby-identifier">options</span>, [<span class="ruby-identifier">:periodicity</span>, <span class="ruby-identifier">:bimonthly</span>, <span class="ruby-identifier">:monthly</span>, <span class="ruby-identifier">:biweekly</span>, <span class="ruby-identifier">:weekly</span>, <span class="ruby-identifier">:yearly</span>, <span class="ruby-identifier">:daily</span>] )
185:       
186:         <span class="ruby-identifier">cycle</span> = <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:periodicity</span>]
187:         <span class="ruby-keyword kw">when</span> <span class="ruby-identifier">:monthly</span>
188:           <span class="ruby-value str">'1m'</span>
189:         <span class="ruby-keyword kw">when</span> <span class="ruby-identifier">:bimonthly</span>
190:           <span class="ruby-value str">'2m'</span>
191:         <span class="ruby-keyword kw">when</span> <span class="ruby-identifier">:weekly</span>
192:           <span class="ruby-value str">'1w'</span>
193:         <span class="ruby-keyword kw">when</span> <span class="ruby-identifier">:biweekly</span>
194:           <span class="ruby-value str">'2w'</span>
195:         <span class="ruby-keyword kw">when</span> <span class="ruby-identifier">:yearly</span>
196:           <span class="ruby-value str">'1y'</span>
197:         <span class="ruby-keyword kw">when</span> <span class="ruby-identifier">:daily</span>
198:           <span class="ruby-value str">'1d'</span>
199:         <span class="ruby-keyword kw">end</span>
200:         
201:         <span class="ruby-identifier">parameters</span> = {
202:           <span class="ruby-identifier">:amount</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">amount</span>(<span class="ruby-identifier">money</span>),
203:           <span class="ruby-identifier">:cycle</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">cycle</span>,
204:           <span class="ruby-identifier">:verify</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:verify</span>] <span class="ruby-operator">||</span> <span class="ruby-value str">'y'</span>,
205:           <span class="ruby-identifier">:billingid</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:billingid</span>] <span class="ruby-operator">||</span> <span class="ruby-keyword kw">nil</span>,
206:           <span class="ruby-identifier">:payments</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:payments</span>] <span class="ruby-operator">||</span> <span class="ruby-keyword kw">nil</span>,
207:         }
208:         
209:         <span class="ruby-identifier">add_creditcard</span>(<span class="ruby-identifier">parameters</span>, <span class="ruby-identifier">creditcard</span>)
210:                                                   
211:         <span class="ruby-identifier">commit</span>(<span class="ruby-value str">'store'</span>, <span class="ruby-identifier">parameters</span>)
212:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000159" class="method-detail">
        <a name="M000159"></a>

        <div class="method-heading">
          <a href="#M000159" class="method-signature">
          <span class="method-name">store</span><span class="method-args">(creditcard, options = {})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
store() requires a TrustCommerce account that is activated for Citatdel.
You can call it with a credit card and a billing ID you would like to use
to reference the stored credit card info for future captures. Use
&#8216;verify&#8217; to specify whether you want to simply store the card
in the DB, or you want TC to verify the data first.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000159-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000159-source">
<pre>
     <span class="ruby-comment cmt"># File lib/active_merchant/billing/gateways/trust_commerce.rb, line 218</span>
218:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">store</span>(<span class="ruby-identifier">creditcard</span>, <span class="ruby-identifier">options</span> = {})   
219:         <span class="ruby-identifier">parameters</span> = {
220:           <span class="ruby-identifier">:verify</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:verify</span>] <span class="ruby-operator">||</span> <span class="ruby-value str">'y'</span>,
221:           <span class="ruby-identifier">:billingid</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:billingid</span>] <span class="ruby-operator">||</span> <span class="ruby-keyword kw">nil</span>,
222:         }
223:         
224:         <span class="ruby-identifier">add_creditcard</span>(<span class="ruby-identifier">parameters</span>, <span class="ruby-identifier">creditcard</span>)
225:         <span class="ruby-identifier">add_address</span>(<span class="ruby-identifier">parameters</span>, <span class="ruby-identifier">options</span>)                              
226:         <span class="ruby-identifier">commit</span>(<span class="ruby-value str">'store'</span>, <span class="ruby-identifier">parameters</span>)
227:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000160" class="method-detail">
        <a name="M000160"></a>

        <div class="method-heading">
          <a href="#M000160" class="method-signature">
          <span class="method-name">unstore</span><span class="method-args">(identification, options = {})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
To unstore a creditcard stored in Citadel using store() or recurring(), all
that is required is the billing id. When you run unstore() the information
will be removed and a <a href="Response.html">Response</a> object will be
returned indicating the success of the action.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000160-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000160-source">
<pre>
     <span class="ruby-comment cmt"># File lib/active_merchant/billing/gateways/trust_commerce.rb, line 231</span>
231:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">unstore</span>(<span class="ruby-identifier">identification</span>, <span class="ruby-identifier">options</span> = {})
232:         <span class="ruby-identifier">parameters</span> = {
233:           <span class="ruby-identifier">:billingid</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">identification</span>,
234:         }
235:                                                   
236:         <span class="ruby-identifier">commit</span>(<span class="ruby-value str">'unstore'</span>, <span class="ruby-identifier">parameters</span>)
237:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>