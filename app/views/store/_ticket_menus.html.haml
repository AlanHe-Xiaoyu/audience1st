#ticket_menus_inner
  = javascript_tag "recalc_total = function() { recalculate('total', '.itemQty', '#{@gAdmin.is_boxoffice ? '' : 'submit'}') }"
  = render :partial => 'enter_promo_code'
  %br/

  - if !(@sh.try(:description).blank?)
    #show_description.explanation= @sh.description

  %label{:for => "show"}= @special_shows_only ? 'Event' : 'Show'
  = select_tag('show', options_with_default(@sh, @all_shows))
  = spinner('wait_show')
  %br/

  %label{:for => "showdate"} Date
  = select_tag('showdate', options_with_default(@sd, @all_showdates))
  = spinner('wait_showdate')
  - privileged_content_for :staff do
    - if (@sd.kind_of?(Showdate))
      %span.admin= "Available: #{@sd.saleable_seats_left} saleable/#{@sd.total_seats_left} in house"
  %br/

  #voucher_menus
    - if @valid_vouchers.empty? && @sd

      %p.explanation No tickets on sale for this performance

    - else

      - @valid_vouchers.each do |v|
        - fieldname = "valid_voucher[#{v.id}]"
        %label{:for => fieldname}= v.name_with_price
        - if @gAdmin.is_boxoffice
          = text_field_tag fieldname, '', :size => 3, :onchange => 'recalc_total()', :class => 'itemQty'
        - else
          = select_tag(fieldname, options_for_select(0..[30,v.max_sales_for_type].min), :onchange => 'recalc_total()', :class => 'itemQty')
        %br/
        = hidden_field_tag "price[#{v.id}]", v.price, {:id => "valid_voucher_#{v.id}_price"}

    - unless @valid_vouchers.empty?
      %label.emphasis Accessible seating requested?
      = checkbox_guard_for 'comments_div', !(@cart.comments.blank?)
      #comments_div{:style => @cart.comments.blank? ? 'display: none' : ''}
        %label{:for => :comments} Please describe (wheelchair, walker, cane, etc.)
        = text_area_tag('comments', @cart.comments, :rows => 1, :cols => 30)

  = watch_show_and_showdate_fields
  = watch_comment_field
