.container#ticket_menus_inner
  = hidden_field_tag 'referer', 'index'
  = hidden_field_tag 'what', @show_type
  = render :partial => 'enter_promo_code'

  %br/

  - if !(@sh.try(:description).blank?)
    #show_description.explanation= @sh.description

  .form-row
    .col-md-4.text-right
      %label.col-form-label{:for => "show"}= label_for_event_type(@what)
    .col-md-4
      = select_tag('show', options_with_default(@sh, @all_shows),                |
        :onchange => "window.location = '#{@show_url}'.replace(/XXXX/,$('#show').val())", :class => 'form-control') |
    .col-md-4

  .form-row
    .col-md-4.text-right
      %label{:for => "showdate"} Date
    .col-md-4
      = select_tag('showdate', options_with_default(@sd, @all_showdates),        |
        :onchange => "window.location = '#{@showdate_url}'.replace(/XXXX/,$('#showdate').val())", :class => 'form-control') |
    .col-md-4
      - privileged_content_for :staff do
        - if (@sd.kind_of?(Showdate))
          %span.text-info= "#{@sd.saleable_seats_left} saleable/#{@sd.total_seats_left} in house"

  #voucher_menus
    - if @valid_vouchers.empty? && @sd
      %p.explanation= @sd.show.sold_out_customer_info
    - else
      - @valid_vouchers.each do |v|
        %div{:id => "vouchertype_#{v.vouchertype_id}",:class => 'row'}
          - fieldname = "valid_voucher[#{v.id}]"
          - max_sales = [30, v.max_sales_for_this_patron].min

          .col-md-4.text-right
            %label.col-form-label{:for => "valid_voucher_#{v.id}"}= v.name_with_price

          - if @is_admin
            .col-md-1
              = text_field_tag fieldname, '', :size => 3, 'data-price' => v.price, :class => 'itemQty form-control'
            .col-md-2
            .col-md-5
              %span.text-info= v.explanation
          - else
            .col-md-1
              = select_tag(fieldname, options_for_select(0..max_sales), 'data-price' => v.price, :class => 'itemQty form-control')
            .col-md-7
              %span.text-info= v.explanation if max_sales.zero?
          = hidden_field_tag "price[#{v.id}]", v.price, {:id => "valid_voucher_#{v.id}_price"}

    - unless @valid_vouchers.empty?
      .form-row
        .col-md-4.text-right
          %label.col-form-label= t('store.accessible_seating_prompt')
        .col-md-6
          = text_area_tag 'comments', @cart.comments, :rows => 1, :class => 'form-control', :placeholder => t('store.accessible_seating_description')
        .col-md-2
