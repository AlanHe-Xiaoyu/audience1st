!!! Strict
%html{:xmlns=>"http://www.w3.org/1999/xhtml","xml:lang"=>:en,:lang=>:en}
  %head
    - if (s = Option.value(:external_css_file)).blank?
      = stylesheet_link_tag 'generic'
    - elsif s.match( /^http:|ftp:/i )
      = stylesheet_link_tag possibly_https(s)
    - else
      = stylesheet_link_tag s
    = stylesheet_link_tag 'vbo'
    = javascript_include_tag :defaults

    %title= @page_title || sprintf("%s: %s", controller.controller_name.capitalize,controller.action_name.humanize)
    %meta{'http-equiv'=>'content-type', :content=>'text/html; charset=utf-8'}/
    %meta{'http-equiv'=>:imagetoolbar, :content=>:no}/
    %meta{:name=>:description, :content=>''}/

  %body{:id=>"#{h(controller.controller_name)}_#{h(controller.action_name)}", :class=>(SANDBOX ? :testing : nil)}

    #outer_wrapper
      #header
      #nav
        - if @gCustomer
          = render :partial => 'layouts/login_banner'
          %ul#store_nav= nav_tabs 'store_nav', [['Buy Tickets', :store, :index], ['My Tickets', :customers, :welcome], ['Billing Address', :customers, :edit],['Change Password', :customers, :change_password]]
          - if @gAdmin.is_staff
            %ul#staff_nav= nav_tabs 'staff_nav',[['Walkup Sales', :store, :walkup],['Customers', :customers, :list],['Shows', :shows, :list],['Voucher Types', :vouchertypes, :list],['Reports', :report, :index],['Donations', :donation, :list]]
            = render :partial => 'customers/quick_search'
            = render :partial => 'customers/staff_buttons'
          - else
            %br.clear

      #inner_wrapper
        %br.clear
        - unless flash[:notice].blank?
          %p.feedback.clear= flash[:notice]

        - unless flash[:warning].blank?
          = render :partial => 'store/warning'

        - unless flash[:checkout_error].blank?
          = render :partial => 'store/checkout_error'

        - if @gCheckoutInProgress
          %h1.center Your Order So Far
          = render :partial => 'store/cart', :locals => {:editable => false,:cart=>@gCart}
        = yield

    = render :partial => 'layouts/footer'
